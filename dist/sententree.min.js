!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("lodash"),require("d3"),require("heap"),require("d3kit"),require("webcola/WebCola/cola.js")):"function"==typeof define&&define.amd?define(["lodash","d3","heap","d3kit","webcola/WebCola/cola.js"],e):"object"==typeof exports?exports.SentenTree=e(require("lodash"),require("d3"),require("heap"),require("d3kit"),require("webcola/WebCola/cola.js")):t.SentenTree=e(t._,t.d3,t.heap,t.d3Kit,t.cola)}(this,function(t,e,n,r,i){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=18)}([function(e){e.exports=t},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,n,r,i){for(var o=-1,s=null,u=0,a=t.words.length,l=(function(e){var n={};t.DBs.forEach(function(t){for(var r=0===e?0:t.seqIndices[e-1]+1,i=e===a?t.tokens.length:t.seqIndices[e],o={},s=r;i>s;s++){var u=t.tokens[s];o[u]||(o[u]=!0,u in n?n[u]+=t.count:n[u]=t.count)}});var l=null,c=0,f=a>0,h=f?Object.keys(n):Object.keys(n).filter(function(t){return!i[t].startsWith("#")});h.forEach(function(t){var e=n[t];r>e&&e>c&&(l=+t,c=e)}),c>u&&(o=e,s=l,u=c)}),c=0;a>=c;c++)l(c);var f=null,h=null;if(u>=n){f={size:0,DBs:[]},h={size:0,DBs:[]};for(var d=t.words,p=0;p<t.DBs.length;p++){var g=t.DBs[p],v=0===o?0:g.seqIndices[o-1]+1,y=o===d.length?g.tokens.length:g.seqIndices[o],k=g.tokens.slice(v,y).indexOf(s);0>k?(f.DBs.push(g),f.size+=g.count):(k+=v,g.seqIndices.splice(o,0,k),h.DBs.push(g),h.size+=g.count)}}return{word:s,pos:o,count:u,s0:f,s1:h}}function s(t,e,n,r,i,s,u){t.words&&t.words.length>0&&(t.graph.nodes=t.graph.nodes.concat(t.words),n-=t.words.length);var a=new h["default"](function(t,e){return e.size-t.size});a.push(t);for(var l=[];!a.empty()&&n>0;){var c=a.pop(),f=c.graph,d=c.r,g=c.l;if(!d&&!g){var v=o(c,s,r,i,u);d=v.s0,g=v.s1;var y=v.word,k=v.pos,m=v.count;if(r>m)l.push(c);else{f||(f=new p["default"](r,i),e.push(f));var b={id:f.totalNodeCnt++,entity:u[y],freq:m,topEntries:g.DBs.slice(0,5),seq:g},w=c.words.slice();w.splice(k,0,b),d.words=c.words,g.words=w,g.newWord=b,d.graph=c.graph,g.graph=f}}g&&(g.graph.nodes.push(g.newWord),n--),c.l=g,c.r=d,g&&a.push(g),d&&d.size>=r&&a.push(d)}return l.concat(a.toArray())}function u(t,e){e.filter(function(e){return t.indexOf(e.graph)>=0}).forEach(function(t){for(var e=t.words,n=t.graph.linkadj,r=0;r<e.length-1;r++){var i=e[r],o=i.id,s=e[r+1].id;o in n||(n[o]={}),s in n[o]?n[o][s]+=t.size:n[o][s]=t.size}e.filter(function(e){return!e.leafSeq||e.leafSeq<t.size}).forEach(function(e){e.leafSeq=t})})}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(r=(s=u.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(a){i=!0,o=a}finally{try{!r&&u["return"]&&u["return"]()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),c=n(0),f=n(7),h=r(f),d=n(11),p=r(d),g=150,v=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,t);var r=e.itemset,o=e.entries;this.tokenizedData=e,this.terms=e.encodeTermWeights(n);var l=e.computeSize();this.supportRange=[Math.max(.001*l,2),l/3];var c=a(this.supportRange,2),f=c[0],h=c[1];this.rootSeq={words:[],newWord:null,graph:null,size:l,DBs:o};var d=[],p=s(this.rootSeq,d,g,f,h,this.terms,r);this.graphs=d.filter(function(t){return t.nodes.length>2}).slice(0,10),u(this.graphs,p)}return l(t,[{key:"updateGraphs",value:function(t){this.graphs.forEach(function(t){return t.clear()});var e=t||this.rootSeq,n=a(this.supportRange,2),r=n[0],i=n[1],o=s(e,this.graphs,g,r,i,this.terms,this.tokenizedData.itemset);return u(this.graphs,o),this}},{key:"size",value:function(){return this.rootSeq.size}},{key:"getRenderedGraphs",value:function(t){var e=1===arguments.length?this.graphs.slice(0,t):this.graphs,n=e.map(function(t){return t.toRenderedGraph()}),r=[c.min(n.map(function(t){return t.freqRange[0]})),c.max(n.map(function(t){return t.freqRange[1]}))],i=0;return n.forEach(function(t){t.globalFreqRange=r,t.nodes.forEach(function(t){t.gid=i,i++})}),n}}]),t}();e["default"]=v},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),s=["i","me","my","myself","we","our","ours","ourselves","you","your","yours","yourself","yourselves","he","him","his","himself","she","her","hers","herself","it","its","itself","they","them","their","theirs","themselves","what","which","who","whom","this","that","these","those","am","is","are","was","were","be","been","being","have","has","had","having","do","does","did","doing","a","an","the","and","but","if","or","because","as","until","while","of","at","by","for","with","about","against","between","into","through","during","before","after","above","below","to","from","up","down","in","out","on","off","over","under","again","further","then","once","here","there","when","where","why","how","all","any","both","each","few","more","most","other","some","such","nor","only","same","so","than","too","very","s","t","can","will","just","don","should","now"],u=["de","la","y","un","que","en","el","shit","fuck","fucking"],a=["rt","via","amp","http","https","m","re","co"],l=o.uniq(s.concat(u).concat(a)),c=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.includeWords,s=void 0===i?[]:i,u=n.excludeWords,a=void 0===u?[]:u,c=n.includeDefault,f=void 0===c?!0:c;r(this,t),this.stopWords=f?l:[],s&&s.length>0&&(this.stopWords=o.uniq(this.stopWords.concat(s))),a&&a.length>0&&!function(){var t=o.keyBy(a,function(t){return t});e.stopWords=e.stopWords.filter(function(e){return!t[e]})}(),this.regex=new RegExp("^("+this.stopWords.join("|")+")$")}return i(t,[{key:"test",value:function(t){return this.regex.test(t)}}]),t}();e["default"]=c;var f=null;c.getDefault=function(){return f||(f=new c),f}},function(t,e){"use strict";function n(t){var e=[];r.lastIndex=0;for(var n=r.exec(t);null!=n;)e.push(n[0].trim()),n=r.exec(t);return e}Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n;var r=/http:\/\/t\.co\/\w+|http:\/\/vine\.co\/\w+|http:\/\/t\.co\w+|http:\/\/vine\.co\w+|http:\/\/t\.\w+|http:\/\/vine\.\w+|http:\/\/\w+|\@\w+|\#\w+|\d+(,\d+)+|\w+(-\w+)*|\$?\d+(\.\d+)?\%?|([A-Z]\.)+/g},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,r,i){n(this,t),this.source=e,this.target=r,this.freq=i,this.attachPoints={x1:0,y1:0,x2:1,y2:1}}return r(t,[{key:"getKey",value:function(){return[this.source.id,this.target.id].join(",")}},{key:"isTheOnlyBridge",value:function(){return 1===this.source.rightLinks.length&&1===this.target.leftLinks.length}},{key:"toConstraint",value:function(){var t=this.isTheOnlyBridge()?5:15;return{axis:"x",left:this.source.id,right:this.target.id,gap:(this.source.width+this.target.width)/2+t}}},{key:"toOnlyBridgeConstraint",value:function(){return{type:"alignment",axis:"y",offsets:[{node:this.source.id,offset:0},{node:this.target.id,offset:0}]}}}]),t}();e["default"]=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),s=function(){function t(e){r(this,t),this.data=e,this.leftLinks=[],this.rightLinks=[],this.id=-1,this.x=0,this.y=0,this.width=50,this.height=18}return i(t,[{key:"isLeaf",value:function(){return 0===this.leftLinks.length||0===this.rightLinks.length}},{key:"isLeftLeaf",value:function(){return 0===this.leftLinks.length}},{key:"isRightLeaf",value:function(){return 0===this.rightLinks.length}},{key:"leftEdge",value:function(){return this.x-this.width/2}},{key:"rightEdge",value:function(){return this.x+this.width/2}},{key:"getLeftNodes",value:function(){return this.leftLinks.map(function(t){return t.source})}},{key:"getRightNodes",value:function(){return this.rightLinks.map(function(t){return t.target})}},{key:"createAlignmentConstraints",value:function(t,e){return e.length>1?{type:"alignment",axis:t,offsets:e.map(function(t){return{node:t.id,offset:0}})}:null}},{key:"computeLeftConstraints",value:function(){var t=this.getLeftNodes().filter(function(t){return 1===t.rightLinks.length});return this.createAlignmentConstraints("x",t)}},{key:"computeRightConstraints",value:function(){var t=this.getRightNodes().filter(function(t){return 1===t.leftLinks.length});return this.createAlignmentConstraints("x",t)}},{key:"computeOrderConstraints",value:function(){var t=[];if(this.getRightNodes().length>1)for(var e=this.getRightNodes(),n=1;n<e.length;n++)t.push({axis:"y",left:e[n-1].id,right:e[n].id,gap:5});if(this.getLeftNodes().length>1)for(var r=this.getLeftNodes(),i=1;i<r.length;i++)t.push({axis:"y",left:r[i-1].id,right:r[i].id,gap:5});return t}},{key:"updateAttachPoints",value:function(){var t=this;1===this.leftLinks.length?this.leftLinks[0].attachPoints.y2=this.y:this.leftLinks.length>1&&!function(){var e=o.sum(t.leftLinks.map(function(t){return t.strokeWidth})),n=t.y-(e+2*(t.leftLinks.length-1))/2;t.leftLinks.concat().sort(function(t,e){return t.source.y-e.source.y}).forEach(function(t){t.attachPoints.y2=n+t.strokeWidth/2,n+=t.strokeWidth+2})}(),1===this.rightLinks.length?this.rightLinks[0].attachPoints.y1=this.y:this.rightLinks.length>1&&!function(){var e=o.sum(t.rightLinks.map(function(t){return t.strokeWidth})),n=t.y-(e+2*(t.rightLinks.length-1))/2;t.rightLinks.concat().sort(function(t,e){return t.target.y-e.target.y}).forEach(function(t){t.attachPoints.y1=n+t.strokeWidth/2,n+=t.strokeWidth+2})}()}},{key:"canMerge",value:function(t){return this.data.entity===t.data.entity}}],[{key:"merge",value:function(e){return new t({id:o.min(e.map(function(t){return t.data.id})),entity:e[0].data.entity,freq:o.sum(e.map(function(t){return t.data.freq})),mergedData:e.map(function(t){return t.data}),topEntries:e.reduce(function(t,e){return t.concat(e.data.topEntries)},[]).slice(0,5)})}}]),t}();e["default"]=s},function(t){t.exports=e},function(t){t.exports=n},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),u=r(s),a=n(13),l=r(a),c=n(2),f=r(c),h=n(3),d=r(h),p=function(t){return t},g=function(){function t(){i(this,t),this._tokenize=d["default"],this._transformToken=p;var e=f["default"].getDefault();this._filterToken=function(t){return!e.test(t)}}return o(t,[{key:"tokenize",value:function(){return 0===arguments.length?this._tokenize:(this._tokenize=arguments.length<=0?void 0:arguments[0],this)}},{key:"transformToken",value:function(){return 0===arguments.length?this._transformToken:(this._transformToken=arguments.length<=0?void 0:arguments[0],this)}},{key:"filterToken",value:function(){return 0===arguments.length?this._filterToken:(this._filterToken=arguments.length<=0?void 0:arguments[0],this)}},{key:"buildTokenizedDataset",value:function(t){var e=this,n=t.map(function(t){return{id:t.id,count:t.count||1,tokens:e._tokenize(t.text).map(e._transformToken).filter(e._filterToken),rawText:t.text}}).filter(function(t){return t.tokens.length>0});return new l["default"](n)}},{key:"buildModel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new u["default"](this.buildTokenizedDataset(t),e)}}]),t}();e["default"]=g},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function y(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:y(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)},c=n(6),f=i(c),h=n(16),d=n(14),p=r(d),g=n(15),v=function(t){function e(t,n){o(this,e);var r=s(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.layers.create(["link","node"]),r.fontSizeScale=f.scaleSqrt().clamp(!0),r.strokeSizeScale=f.scaleSqrt().domain([1,100]).range([1,6]).clamp(!0),r.layouts=[],r.updatePosition=r.updatePosition.bind(r),r.visualize=r.visualize.bind(r),r.on("data",r.visualize),r.on("options",r.visualize),r}return u(e,t),a(e,null,[{key:"getDefaultOptions",value:function(){return h.helper.deepExtend(l(e.__proto__||Object.getPrototypeOf(e),"getDefaultOptions",this).call(this),{initialWidth:800,initialHeight:200,margin:{left:0,top:0,bottom:0,right:0},fontSize:[10,32],gapBetweenGraph:10})}},{key:"getCustomEventNames",value:function(){return["layoutStart","layoutTick","layoutEnd","nodeMouseenter","nodeMouseleave","nodeMousemove","nodeClick","linkMouseenter","linkMouseleave","linkMousemove","linkClick"]}}]),a(e,[{key:"fontSize",value:function(t){return Math.round(this.fontSizeScale(t.data.freq))+"px"}},{key:"renderNodes",value:function(t){var e=this,n=this.layers.get("node").selectAll("g.graph").data(t);n.exit().remove();var r=n.enter().append("g").classed("graph",!0);this.sNodeGraphs=n.merge(r).attr("transform","translate("+this.getInnerWidth()/2+","+this.getInnerHeight()/2+")");var i=r.selectAll("g").data(function(t){return t.nodes},function(t){return t.id});i.exit().remove(),i.enter().append("g").classed("node",!0).append("text").attr("dy",".28em").text(function(t){return t.data.entity}).style("cursor","pointer").on("click.event",this.dispatchAs("nodeClick")).on("mouseenter.event",this.dispatchAs("nodeMouseenter")).on("mousemove.event",this.dispatchAs("nodeMousemove")).on("mouseleave.event",this.dispatchAs("nodeMouseleave")),this.sNodes=this.layers.get("node").selectAll("g.node"),this.sNodes.select("text").style("font-size",function(t){return e.fontSize(t)}).style("text-anchor","middle")}},{key:"renderLinks",value:function(t){var e=this,n=this.layers.get("link").selectAll("g.graph").data(t);n.exit().remove();var r=n.enter().append("g").classed("graph",!0);this.sLinkGraphs=n.merge(r).attr("transform","translate("+this.getInnerWidth()/2+","+this.getInnerHeight()/2+")");var i=r.selectAll("path.link").data(function(t){return t.links},function(t){return t.getKey()});i.exit().remove(),i.enter().append("path").classed("link",!0).on("click.event",this.dispatchAs("linkClick")).on("mouseenter.event",this.dispatchAs("linkMouseenter")).on("mousemove.event",this.dispatchAs("linkMousemove")).on("mouseleave.event",this.dispatchAs("linkMouseleave")).style("vector-effect","non-scaling-stroke").style("opacity",.5).style("stroke","#222").style("fill","none"),t.forEach(function(t){t.links.forEach(function(n){n.strokeWidth=Math.round(e.strokeSizeScale(n.freq/t.minSupport))})}),this.sLinks=this.layers.get("link").selectAll("path.link").style("stroke-width",function(t){return t.strokeWidth+"px"}).style("stroke",function(t){return t.isTheOnlyBridge()?"#777":"#FF9800"})}},{key:"updatePosition",value:function(){var t=0,e=0,n=this.options(),r=n.margin,i=n.gapBetweenGraph,o=r.top,s=r.left,u=r.bottom,a=r.right;this.sNodeGraphs.each(function(n){var r=this.getBBox(),o=r.width,s=r.height;e=Math.max(o,e),n.x=-r.x,n.y=-r.y+t,t+=s+i}),this.sNodeGraphs.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),this.sLinkGraphs.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),this.dimension([e+s+a,Math.max(0,t-i)+o+u]),this.placeNodes(),this.placeLinks()}},{key:"placeNodes",value:function(){this.sNodes.attr("transform",function(t){return"translate("+t.x+", "+t.y+")"})}},{key:"placeLinks",value:function(){var t=this.data();t.forEach(function(t){t.nodes.forEach(function(t){t.updateAttachPoints()})}),this.sLinks.attr("d",function(t){var e=[t.source.rightEdge(),t.attachPoints.y1,t.target.leftEdge(),t.attachPoints.y2];return g.diagonal.apply(void 0,e)})}},{key:"visualize",value:function(){if(this.hasData()){var t=this.data();if(t.length>0){var e=this.options(),n=e.fontSize;this.fontSizeScale.domain(t[0].globalFreqRange).range(n)}this.renderNodes(t),this.renderLinks(t),this.sNodes.each(function(t){var e=this.getBBox();t.width=e.width+4,t.height=e.height+4});for(var r=Math.max(t.length,this.layouts.length),i=0;r>i;i++)i>=this.layouts.length&&this.layouts.push((new p["default"]).on("tick",this.updatePosition)),i>=t.length?this.layouts[i].stop().destroy():this.layouts[i].stop().setGraph(t[i]).start();this.layouts=this.layouts.slice(0,t.length),this.updatePosition()}}}]),e}(h.SvgChart);e["default"]=v},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(0),u=n(7),a=r(u),l=n(4),c=r(l),f=n(5),h=r(f),d=function(){function t(e,n){i(this,t),this.nodes=e,this.links=n,this.linkLookup=s.keyBy(this.links,function(t){return t.getKey()})}return o(t,[{key:"addLinks",value:function(t){var e=this;this.links=this.links.concat(t),t.forEach(function(t){e.linkLookup[t.getKey()]=t})}},{key:"bundle",value:function(){var t=this,e=new a["default"](function(t,e){return t.data.id-e.data.id});for(this.nodes.filter(function(e){return t.hasPotential(e)}).forEach(function(t){e.push(t)});e.size()>0;){var n=e.pop();if(!n.merged){var r=[];if(n.leftLinks.length>1){var i=n.leftLinks.map(function(t){return t.source});r=r.concat(this.groupMergeableNodes(i))}if(n.rightLinks.length>1){var o=n.rightLinks.map(function(t){return t.target});r=r.concat(this.groupMergeableNodes(o))}if(r.length>0){var s=r.map(function(e){return t.mergeNodes(e)});s.filter(function(e){return t.hasPotential(e)}).forEach(function(t){e.push(t)})}}}return{nodes:this.nodes.filter(function(t){return!t.merged}),links:this.links.filter(function(t){return!t.source.merged&&!t.target.merged})}}},{key:"groupMergeableNodes",value:function(t){var e=this.linkLookup;return s.chain(t).groupBy(function(t){return t.data.entity}).values().filter(function(t){return t.length>1}).flatMap(function(t){for(var n=[[t[0]]],r=function(r){for(var i=t[r],o=0;o<n.length;o++){var s=n[o];s.every(function(t){return!e[[t.id,i.id].join(",")]&&!e[[t.id,i.id].join(",")]})?s.push(i):n.push([i])}},i=1;i<t.length;i++)r(i);return n.filter(function(t){return t.length>1})}).value()}},{key:"hasPotential",value:function(t){return t.rightLinks.length>1||t.leftLinks.length>1}},{key:"mergeNodes",value:function(t){var e=h["default"].merge(t);return e.id=this.nodes.length,this.nodes.push(e),t.forEach(function(t){t.merged=!0}),e.rightLinks=s.chain(t).flatMap(function(t){return t.rightLinks}).groupBy(function(t){return t.target.id}).mapValues(function(t){var n=t[0].target;n.leftLinks=n.leftLinks.filter(function(t){return!t.source.merged});var r=new c["default"](e,t[0].target,s.sum(t.map(function(t){return t.freq})));return n.leftLinks.push(r),r}).values().value(),this.addLinks(e.rightLinks),e.leftLinks=s.chain(t).flatMap(function(t){return t.leftLinks}).groupBy(function(t){return t.source.id}).mapValues(function(t){var n=t[0].source;n.rightLinks=n.rightLinks.filter(function(t){return!t.target.merged});var r=new c["default"](t[0].source,e,s.sum(t.map(function(t){return t.freq})));return n.rightLinks.push(r),r}).values().value(),this.addLinks(e.leftLinks),e}}]),t}();e["default"]=d},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(12),u=r(s),a=function(){function t(e,n){i(this,t),this.nodes=[],this.linkadj=[],this.minSupport=e,this.maxSupport=n,this.totalNodeCnt=0}return o(t,[{key:"clear",value:function(){return this.nodes=[],this.linkadj=[],this}},{key:"toRenderedGraph",value:function(){return new u["default"](this)}}]),t}();e["default"]=a},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(0),u=n(10),a=r(u),l=n(4),c=r(l),f=n(5),h=r(f),d=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.bundle,o=void 0===r?!0:r,u=n.highFrequencyOnTop,l=void 0===u?!0:u;i(this,t),this.options={bundle:o,highFrequencyOnTop:l},this.minSupport=e.minSupport,this.maxSupport=e.maxSupport;var f=e.nodes.map(function(t){return new h["default"](t)}),d=[];if(Object.keys(e.linkadj).forEach(function(t){var n=f[t],r=e.linkadj[t];Object.keys(r).forEach(function(t){var e=f[t],i=new c["default"](n,e,r[t]);d.push(i),n.rightLinks.push(i),e.leftLinks.push(i)})}),this.assignNodeIds(f),o){var p=new a["default"](f,d).bundle();this.nodes=p.nodes,this.links=p.links,this.assignNodeIds(this.nodes)}else this.nodes=f,this.links=d;l&&this.nodes.forEach(function(t){t.rightLinks.sort(function(t,e){return e.freq-t.freq}),t.leftLinks.sort(function(t,e){return e.freq-t.freq})});var g=this.nodes.map(function(t){return t.data.freq});this.freqRange=[s.min(g),s.max(g)],this.globalFreqRange=this.freqRange;var v=this.links.filter(function(t){return t.isTheOnlyBridge()}).map(function(t){return t.toOnlyBridgeConstraint()});this.baseConstraints=v.concat(this.getAlignmentConstraints())}return o(t,[{key:"updateNodeSize",value:function(t){return this.nodes.forEach(function(e){var n=t(e),r=n.width,i=n.height;e.width=r,e.height=i}),this}},{key:"assignNodeIds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t.forEach(function(t,n){t.id=n+e}),this}},{key:"getAlignmentConstraints",value:function(){var t=[];if(this.nodes.length>0){for(var e=this.nodes.map(function(){return!1}),n=[this.nodes[0]];n.length>0;){var r=n.shift(),i=r.id;if(!e[i]){e[i]=!0;var o=r.computeRightConstraints();o&&t.push(o);var s=r.getRightNodes();s.length>0&&(n=n.concat(s))}}for(var u=0;u<this.nodes.length;u++)e[u]=!1;for(n=[this.nodes[0]];n.length>0;){var a=n.shift(),l=a.id;if(!e[l]){e[l]=!0;var c=a.computeLeftConstraints();c&&t.push(c);var f=a.getLeftNodes();f.length>0&&(n=n.concat(f))}}}return t}},{key:"getLinkConstraints",value:function(){return this.links.map(function(t){return t.toConstraint()})}},{key:"getConstraints",value:function(){var t=this.baseConstraints.concat(this.links.map(function(t){return t.toConstraint()}));return this.options.highFrequencyOnTop?t.concat(s.flatMap(this.nodes,function(t){return t.computeOrderConstraints()})):t}},{key:"toGroupConstraint",value:function(){return{leaves:this.nodes.map(function(t){return t.id})}}}]),t}();e["default"]=d},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(0),s=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];r(this,t),this.vocabularies={},this.itemset=[],this.entries=n.map(function(t){var n=t.id,r=t.count,i=t.tokens,o=t.rawText;return{id:n,count:r,tokens:i.map(function(t){return e.encode(t)}),rawText:o,seqIndices:[]}})}return i(t,[{key:"hasToken",value:function(t){return this.vocabularies.hasOwnProperty(t)}},{key:"hasCode",value:function(t){return t>=0&&t<this.itemset.length}},{key:"getCode",value:function(t){return this.vocabularies[t]}},{key:"encode",value:function(t){if(this.vocabularies.hasOwnProperty(t))return this.vocabularies[t];var e=this.itemset.length;return this.itemset.push(t),this.vocabularies[t]=e,e}},{key:"decode",value:function(t){return this.itemset[t]}},{key:"encodeTermWeights",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e).filter(function(e){return t.hasToken(e)}).reduce(function(n,r){return n[t.getCode(r)]=e[r],n},{})}},{key:"computeSize",value:function(){return o.sum(this.entries.map(function(t){return t.count}))}}]),t}();e["default"]=s},function(t,e,n){"use strict";function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(6),u=r(s),a=n(17),l=function(){function t(){var e=this;i(this,t),this.isRunning=!1,this.simulation=a.d3adaptor(u).flowLayout("x",5).avoidOverlaps(!0).jaccardLinkLengths(10).linkDistance(5),this.dispatcher=u.dispatch("start","tick","end"),this.simulation.on("start.default",function(){e.isRunning=!0,e.dispatcher.call("start",e)}),this.simulation.on("tick.default",function(){e.dispatcher.call("tick",e)}),this.simulation.on("end.default",function(){e.isRunning&&(e.isRunning=!1,e.dispatcher.call("end",e))})}return o(t,[{key:"on",value:function(){var t;return(t=this.dispatcher).on.apply(t,arguments),this}},{key:"setGraph",value:function(t){return this.simulation.nodes(t.nodes).links(t.links).constraints(t.getConstraints()),this}},{key:"start",value:function(){return this.simulation.start(10,10,10),this}},{key:"stop",value:function(){return this.simulation.stop(),this}},{key:"destroy",value:function(){return this.dispatcher.on("start",null),this.dispatcher.on("tick",null),this.dispatcher.on("end",null),this.simulation.on("start",null),this.simulation.on("tick",null),this.simulation.on("end",null),this}}]),t}();e["default"]=l},function(t,e){"use strict";function n(t,e,n,r){return"M"+t+","+e+"C"+(t+n)/2+","+e+" "+(t+n)/2+","+r+" "+n+","+r}function r(t,e,n,r){return"M "+t+","+e+" L "+n+","+r}Object.defineProperty(e,"__esModule",{value:!0}),e.diagonal=n,e.line=r},function(t){t.exports=r},function(t){t.exports=i},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var i=n(3);Object.defineProperty(e,"tokenize",{enumerable:!0,get:function(){return r(i)["default"]}});var o=n(2);Object.defineProperty(e,"WordFilter",{enumerable:!0,get:function(){return r(o)["default"]}});var s=n(8);Object.defineProperty(e,"SentenTreeBuilder",{enumerable:!0,get:function(){return r(s)["default"]}});var u=n(1);Object.defineProperty(e,"SentenTreeModel",{enumerable:!0,get:function(){return r(u)["default"]}});var a=n(9);Object.defineProperty(e,"SentenTreeVis",{enumerable:!0,get:function(){return r(a)["default"]}})}])});